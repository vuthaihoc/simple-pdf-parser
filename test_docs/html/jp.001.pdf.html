<!DOCTYPE html>
<html lang="en-US">
<head>
<title>html from pdf</title>
<meta charset="utf-8">
<style>body{font-size: 18px;}</style>
<body>
<div data-page='1' style='padding: 20px;margin: 10px auto;max-width: 800px;'><p>Page 1</p><p>平成28年度 上級計量経済学
</p>
<p>講義ノート6: 被説明変数のとりうる値に制約のあるモデル(Limited dependent
variable models)
</p>
<p>このノートでは、質的選択モデルや切断回帰モデル、打ち切り回帰モデルなどといった、
被説明変数のとりうる値に制約のかかっているモデルの紹介と、その解説を行う。
</p>
<p>従属変数が、家や車などの耐久消費財を保有しているか否か、といった選択データの分
析には質的選択モデル（qualitative response model）が用いられる。その最も基本的なモデ
ルが2値選択モデル（binary choice model）である。
</p>
<p>また、被説明変数が、ある閾値を越えるとデータに出てこなくなる場合は、切断回帰モ
デル(truncated regression model)、被説明変数のみが観測できなくなる場合は打ち切り回
帰モデル(censored regression model)が用いられる。
</p>
<p>6.1 2値選択モデル
</p>
<p>yiを0か1の値を取る被説明変数、Xiをk次元の説明変数、Fをある分布関数として、
</p>
<p>P(yi = 1|Xi) =F(Xi′β) (1)
</p>
<p>を2値選択モデルという。(1)は、以下のような状況から導出される。
1. 潜在変数モデル(Latent variable model)
</p>
<p>例えば、Xを個人の属性として、家を保有している場合はy= 1、保有していない場
合はy = 0とする。個人iはy∗
</p>
<p>i =X
</p>
<p>′
</p>
<p>iβ+ϵiの値が正か負かによって意思決定を行う
</p>
<p>が、y∗
</p>
<p>i 自体は観測されない変数（latent variable）である。y
</p>
<p>∗が正の場合は
</p>
<p>y = 1、負
の場合はy= 0となるものとする。つまり、
</p>
<p>y∗
</p>
<p>i = X
</p>
<p>′
</p>
<p>iβ+ϵi (2)
</p>
<p>yi = I(yi∗ ≥0) (3)
</p>
<p>としてデータは生成される。また、Xiとϵiは独立とし、−ϵiの分布関数をFとする。
</p>
<p>そのとき、
</p>
<p>P(yi = 1|Xi) = P(y∗i ≥0|Xi) (4)
</p>
<p>= P(X′
</p>
<p>iβ+ϵi ≥0|Xi) (5)
</p>
<p>= P(<sub>−</sub>ϵi≤Xi′β|Xi) (6)
</p>
<p>= F(X′
</p>
<p>iβ) (7)
</p>
<p>となる。
</p>
<p>2. 確率的効用モデル
</p>
<p>例えば、個人iが通勤に車を使う(yi= 1)か、公共交通機関を使う(yi = 0)かを決める問
</p>
<p>題を考える。前者の場合の効用はu1i =z1′iβ+ϵ1i、後者の場合の効用はu0i =z0′iβ+ϵ0i
</p>
<p>とする。zは説明変数で、たとえば所要時間、費用等である。また、ϵ0i−ϵ1iの分布関
</p>
<p>数をF とし、Xi =z1i−z0iとする。効用最大化を仮定すると、個人iの意思決定は
</p>
<p>次のように表される。
</p>
<p>P(yi= 1|Xi) = P(u1i≥u0i|Xi) (8)
</p>
<p>= P<sub>{</sub>(z′
</p>
<p>1iβ+ϵ1i)−(z0′iβ+ϵ0i)≥0|Xi} (9)
</p>
<p>= P(ϵ0i−ϵ1i ≤(z1i−z0i)′β|Xi) (10)
</p>
<p>= F(X′
</p>
<p>iβ) (11)
</p>
</div>
<div data-page='2' style='padding: 20px;margin: 10px auto;max-width: 800px;'><p>Page 2</p><p>実証上よく用いられる特定化は
</p>
<p>• 線形確率モデル： F(x) =x。
</p>
<p>この場合はOLS推定することが可能である。ただし、線形確率モデルではxが負値
や１より大きい値はとれないので、注意して適用する必要がある。
</p>
<p>• プロビット(probit)モデル： 
</p>
<p>F(x) = Φ(x) =
∫ x
</p>
<p>−∞
</p>
<p>1
√
</p>
<p>2π exp
(
</p>
<p>−t
</p>
<p>2
</p>
<p>2
)
</p>
<p>dt (12)
</p>
<p>（正規分布）
</p>
<p>• ロジット(logit)モデル：  
</p>
<p>F(x) = Λ(x) = exp(x)
</p>
<p>1 + exp(x) (13)
</p>
<p>（ロジスティック分布）
</p>
<p>プロビットモデルやロジットモデルは、yiをXiに回帰するOLSでは推定できない。な
</p>
<p>ぜなら、単純化のために説明変数Xはスカラー、定数項を含めるものとして
</p>
<p>E(βOLS|X) =
</p>
<p>∑n
</p>
<p>i=1(Xi−X)E(y¯ i|Xi)
</p>
<p>∑n
</p>
<p>i=1(Xi−X)¯ 2
</p>
<p>=
∑n
</p>
<p>i=1(Xi−X)F(X¯
′
iβ)
</p>
<p>∑n
</p>
<p>i=1(Xi−X)¯ 2 ̸
</p>
<p>=β (14)
</p>
<p>だからである。βはML推定することができる。
</p>
<p>6.2 2値選択モデルの最尤推定
</p>
<p>2値選択モデルを最尤推定を議論するために、まずは尤度関数を導出する。(yi, Xi), i =
</p>
<p>1, . . . , nを無作為標本とする。各個人の確率関数は
</p>
<p>P(yi = 1|Xi) = F(Xi′β) (15)
</p>
<p>P(yi = 0|Xi) = 1−F(Xi′β) (16)
</p>
<p>なので、
</p>
<p>P(yi =y|Xi) =F(Xi′β)y[1−F(X
′
iβ)]
</p>
<p>1−y <sub>(y</sub> <sub>= 1,</sub><sub>0)</sub> <sub>(17)</sub>
</p>
<p>と書き換えることができる。したがって、尤度関数は、
</p>
<p>L(β) =
</p>
<p>n
</p>
<p>∏
</p>
<p>i=1
</p>
<p>F(X′
iβ)y
</p>
<p>i
</p>
<p>[1−F(X′
iβ)]
</p>
<p>1−yi
</p>
<p>(18)
</p>
<p>であり、対数尤度関数は
</p>
<p>logL(β) =
</p>
<p>n
</p>
<p>∑
</p>
<p>i=1
</p>
<p>yilogF(Xi′β) + (1−yi) log[1−F(Xi′β)] (19)
</p>
<p>となる。また、パラメータ空間をΘとして、最尤推定量は
ˆ
</p>
<p>β = arg max
</p>
<p>β∈ΘlogL(β) (20)
</p>
</div>
<div data-page='3' style='padding: 20px;margin: 10px auto;max-width: 800px;'><p>Page 3</p><p>で定義される。
</p>
<p>この推定量は、Wi= (yi, Xi)、
</p>
<p>m(Wi;β) =yilogF(Xi′β) + (1−yi) log[1−F(Xi′β)] (21)
</p>
<p>とすると、M推定量の特殊ケースになり、極値推定量の理論を用いて、漸近的性質を調べる
ことができる。以下では、条件付き最尤推定量に限って漸近理論を述べる。条件付き最尤推
定量というのは、Xiを条件づけた尤度関数を考えており、Xiの密度も考慮に入れたデータ
</p>
<p>全体の分布を元にした尤度関数を考えている訳ではないからである。
</p>
<p>6.3 一般的な最尤推定量の漸近理論
</p>
<p>一般的な(条件付き)最尤推定量の漸近理論を述べよう。以下では、(yi, Xi)、i= 1, . . . , nは
</p>
<p>i.i.d.であると仮定する。Xiを条件とするyiの条件付き密度（または確率）はf(yi|Xi;θ)で
</p>
<p>あるとする。そのとき、θの最尤推定量は、
</p>
<p>ˆ
</p>
<p>θ= arg max
</p>
<p>θ logL(θ) =
n
</p>
<p>∑
</p>
<p>i=1
</p>
<p>logf(yi|Xi;θ) (22)
</p>
<p>である。
</p>
<p>命題 1 (条件付き最尤推定量の一致性（母数空間がコンパクトな場合）). 以下の仮定をお
く。
</p>
<p>(i) パラメータ空間Θはk次元ユークリッド空間のコンパクトな集合である。
(ii) f(yi|Xi;θ)はすべての(yi, Xi)に対してθについて連続である。
</p>
<p>(iii) (識別) 全てのθ0でないθ∈Θについて、P[f(yi|Xi;θ)̸=f(yi|Xi;θ0)]&gt;0
</p>
<p>(iv) (押さえ込み)E[sup<sub>θ∈Θ</sub><sub>|</sub>logf(yi|Xi;θ)|]&lt;∞
</p>
<p>そのとき、
</p>
<p>ˆ
</p>
<p>θ<sub>→</sub>pθ0 (23)
</p>
<p>(iii)は若干回りくどい表現に思われるが、言いかえると、θ=θ0のときのみf(yi|Xi;θ) =
</p>
<p>f(yi|Xi;θ0)ということである。次に、パラメータ空間のコンパクト性を仮定しない結果を
</p>
<p>示す。
</p>
<p>命題 2. 条件付き（疑似）最尤推定量の一致性（コンパクト性を仮定しない場合）
以下の仮定をおく。
</p>
<p>(i)’パラメータ空間Θはk次元ユークリッド空間の凸集合で、真の値θ0はΘの内点である。
</p>
<p>(ii)’ logf(yi|Xi;θ)はすべての(yi, Xi)に対してθについて凹(concave)である。
</p>
<p>(iii) (識別) P[f(yi|Xi;θ)̸=f(yi|Xi;θ0)]&gt;0, ∀θ, θ̸=θ0, θ∈Θ
</p>
<p>(iv)’ (押さえ込み)E[|logf(yi|Xi;θ)|]&lt;∞, ∀θ∈Θ
</p>
<p>そのとき、
</p>
<p>ˆ
</p>
<p>θ→pθ0 (24)
</p>
<p>情報不等式 上の二つの定理の識別条件が、極値推定量の識別条件になっていることは、情
報不等式と呼ばれる不等式によって、示すことができる。密度関数f(x, θ)によって最尤推
定する場合を考える。また真の分布はf(x, θ0)であるとする。このときJensenの不等式に
</p>
<p>よって、
</p>
<p>E
{
</p>
<p>log
[
</p>
<p>f(x, θ)
f(x, θ0)
</p>
<p>]}
</p>
<p>≤logE
[
</p>
<p>f(x, θ)
f(x, θ0)
</p>
<p>]
</p>
<p>(25)
</p>
</div>
<div data-page='4' style='padding: 20px;margin: 10px auto;max-width: 800px;'><p>Page 4</p><p>が成り立つ。しかし、
</p>
<p>E
[
</p>
<p>f(x, θ)
f(x, θ0)
</p>
<p>]
=
</p>
<p>∫
</p>
<p>f(x, θ)
f(x, θ0)
</p>
<p>f(x, θ0)dx=
</p>
<p>∫
</p>
<p>f(x, θ)dx= 1 (26)
が成り立つ。よって、
</p>
<p>E
{
</p>
<p>log
[
</p>
<p>f(x, θ)
f(x, θ0)
</p>
<p>]}
</p>
<p>≤0 (27)
</p>
<p>であり、ここから、
</p>
<p>E[logf(x, θ)]<sub>≤</sub>E[logf(x, θ0)] (28)
</p>
<p>となる。つまり、対数尤度の極限の関数は、真値θ0で最大値をとる。Jensenの不等式の条
</p>
<p>件から、確率1でf(x, θ)とf(x, θ0)が一致しない限り、不等式は強い不等式であることが
</p>
<p>わかる。したがって、極値推定量の識別条件は満たされることになる。
</p>
<p>次に、漸近正規性を述べる。命題1または2の条件が成立し、従ってθˆ<sub>→</sub>p θ0であると
</p>
<p>する。
</p>
<p>命題 3 (条件付き最尤推定量の漸近正規性). 以下を仮定する。
(i) θ0はΘの内点である。（命題2では仮定済み）
</p>
<p>(ii) f(yi|Xi;θ)はすべての(yi, Xi)に対してθについて２回連続微分可能である。
</p>
<p>(iii) s(yi, Xi;θ) = ∂logf(yi|Xi;θ)/(∂θ)、H(yi, Xi;θ) = ∂2logf(yi|Xi;θ)/(∂θ∂θ′)と
</p>
<p>して、
</p>
<p>E[s(yi, Xi;θ0)] = 0, −E[H(yi, Xi;θ0)] =E[s(yi, Xi;θ0)s(yi, Xi;θ0)′] (29)
</p>
<p>が成り立つ。
</p>
<p>(iv) (ヘシアン行列の近傍での押さえ込み条件)θ0の近傍N に対して、
</p>
<p>E[sup
</p>
<p>θ∈N||
</p>
<p>H(yi, Xi;θ)||]&lt;∞ (30)
</p>
<p>であり、従って任意の<sub>θ</sub>¯<sub>→</sub><sub>p</sub> <sub>θ</sub><sub>0</sub><sub>に対して</sub>
</p>
<p>1
n
</p>
<p>n
</p>
<p>∑
</p>
<p>i=1
</p>
<p>H(yi, Xi; ¯θ)→p E[H(yi, Xi;θ0)] (31)
</p>
<p>(v) I(θ0) =−E[H(yi, Xi;θ0)]は非特異である。
</p>
<p>そのとき、
</p>
<p>√
</p>
<p>n(ˆθ<sub>−</sub>θ0)→dN(0, I(θ0)−1) (32)
</p>
<p>である。
</p>
<p>スコア関数s(yt, xt, θ0)の期待値が0となることは、w= (y, x)としてa(w;θ) =f(w, θ)
</p>
<p>について、以下の微分と積分の入れ替えが成立すれば成立する。
∂
</p>
<p>∂θ
∫
</p>
<p>a(w, θ)dw =
∫ <sub>∂</sub>
</p>
<p>∂θa(w, θ)dw (33)
</p>
<p>通常の計量経済モデルではこれは成立するが、そのための十分条件はNewey and McFadden
(1994, Lemma 3.6, p.2152)を参照。f(x, θ)を密度関数とする場合を考えると、
</p>
<p>∫
</p>
<p>f(x, θ)dx= 1 (34)
</p>
</div>
<div data-page='5' style='padding: 20px;margin: 10px auto;max-width: 800px;'><p>Page 5</p><p>であるので、両辺を微分して、
∂
∂θ
</p>
<p>∫
</p>
<p>f(x, θ)dx= 0 (35)
</p>
<p>であるが、積分と微分を入れ替えると、
</p>
<p>0 =
∫ <sub>∂</sub>
</p>
<p>∂θf(x, θ)dx=
</p>
<p>∫ <sub>∂</sub><sub>log</sub><sub>f</sub><sub>(x, θ)</sub>
</p>
<p>∂θ f(x, θ)dx=
∫
</p>
<p>s(x, θ)f(x, θ)dx (36)
となるからである。
</p>
<p>情報等式 (iii)の二つめの不等式は情報等式と呼ばれる。これは、w= (y, X)としてa(w;θ) =
[∂logf(w, θ)/(∂θ)]f(w;θ)について、微分と積分の入れ替え
</p>
<p>∂
∂θ
</p>
<p>∫
</p>
<p>a(w, θ)dw =
∫ <sub>∂</sub>
</p>
<p>∂θa(w, θ)dw (37)
</p>
<p>ができれば、情報等式は成り立つ。この入れ替えの十分条件はNewey and McFadden (1994,
Lemma 3.6, p.2152)を参照。証明は先ほどと同じように、f(x, θ)を密度関数とする場合を
考えると、
</p>
<p>0 =
∫
</p>
<p>s(x, θ)f(x, θ)dx (38)
</p>
<p>が成り立ち、これをさらに微分すると、
</p>
<p>0 =
∫
</p>
<p>H(x, θ)f(x, θ)dx+
∫
</p>
<p>s(x, θ)s(x, θ)dx (39)
となるからである。
</p>
<p>6.4 ロジットモデルとプロビットモデルのMLEの漸近的性質
</p>
<p>以下に、命題2に基づいてロジットモデル、プロビットモデルの場合について(20)の解の
一致性を示す。なお、微分可能性等の条件のもとでは、f(x) = dF(x)/dxとすると、MLE
の一階の条件は
</p>
<p>∂logL( ˆβ)
</p>
<p>∂β =
</p>
<p>n
</p>
<p>∑
</p>
<p>i=1
</p>
<p>yi−F(Xi′β)ˆ
</p>
<p>F(X′
</p>
<p>iβ)[1ˆ −F(X
′
iβ)]ˆ
</p>
<p>f(X′
</p>
<p>iβ)Xˆ i= 0 (40)
</p>
<p>となる。また、２階の条件は
</p>
<p>∂2
</p>
<p>logL( ˆβ)
</p>
<p>∂β∂β′ = −
n
</p>
<p>∑
</p>
<p>i=1
</p>
<p>{
</p>
<p>yi−F(Xi′βˆ)
</p>
<p>F(X′
</p>
<p>iβ)[1ˆ −F(Xi′β)]ˆ
</p>
<p>}2
</p>
<p>f(X′
iβ)ˆ
</p>
<p>2
</p>
<p>XiXi′
</p>
<p>+
</p>
<p>n
</p>
<p>∑
</p>
<p>i=1
</p>
<p>yi−F(Xi′β)ˆ
</p>
<p>F(X′
</p>
<p>iβ)[1ˆ −F(X
′
iβ)]ˆ
</p>
<p>f′
</p>
<p>(X′
</p>
<p>iβ)Xˆ iXi′
</p>
<p>&lt; 0 (41)
</p>
<p>である。
</p>
<p>定理 1 (ロジットモデルとプロビットモデルのMLEの一致性). Θ =Rk<sub>で</sub><sub>E</sub><sub>||</sub><sub>X</sub>
</p>
<p>iX<sub>i</sub>′||&lt;∞,
</p>
<p>E(XiXi′)が非特異行列であるとき、
</p>
<p>ˆ
</p>
<p>β →p β0 (42)
</p>
<p>である。
</p>
</div>
<div data-page='6' style='padding: 20px;margin: 10px auto;max-width: 800px;'><p>Page 6</p><p>（証明） 命題2の各条件が成立していることを示せばよい。(i)’は明らかである。
</p>
<p>(ii)’について、ロジットモデルの場合のみ示す（プロビットの場合は若干厄介であるが、
</p>
<p>Amemiya (1985, p.273-274; p273最終式に誤植の可能性あり)を参照）。簡単な計算から
f(u) = Λ′
</p>
<p>(u) = Λ(u)[1<sub>−</sub>Λ(u)] (43)
</p>
<p>f′
</p>
<p>(u) = Λ′′
</p>
<p>(u) = [1<sub>−</sub>2Λ(u)]Λ(u)[1<sub>−</sub>Λ(u)] (44)
であることがわかる。したがって、(41) の等式部分にF = Λを代入して2次微分を計算す
ると、yi(1−yi) = 0を用いて
</p>
<p>∂2
</p>
<p>logL(β)
∂β∂β′ =−
</p>
<p>n
</p>
<p>∑
</p>
<p>i=1
</p>
<p>Λ(X′
</p>
<p>iβ)[1−Λ(X
</p>
<p>′
</p>
<p>iβ)]XiXi′ (45)
</p>
<p>であることがわかる。0&lt;Λ(X′
</p>
<p>iβ)&lt;1またE(XiXi′)&gt;0なので、(ii)’が成立する。
</p>
<p>(iii) 仮定よりE(XiXi′)は正値定符号であるから、E(X
′
iβ−X
</p>
<p>′
</p>
<p>iβ0)2= (β−β0)′E(XiXi′)(β−
</p>
<p>β0)より、β ̸=β0ならE(X<sub>i</sub>′β−X<sub>i</sub>′β0)2 ̸= 0である。従って、β ̸=β0のときP(X<sub>i</sub>′β ̸=X<sub>i</sub>′β0)&gt;
</p>
<p>0でなければならない。すると、正規分布、ロジット分布の分布関数は狭義の増加関数なの
で、P[F(X′
</p>
<p>iβ)̸=F(X
′
</p>
<p>iβ0)]&gt;0が成立する。さて、
</p>
<p>f(yi|Xi;β) = F(Xi′β)y
</p>
<p>i
</p>
<p>[1<sub>−</sub>F(X′
iβ)]1−y
</p>
<p>i
</p>
<p>(46)
なので、
</p>
<p>P[f(yi|Xi;β) =f(yi|Xi;β0)] (47)
</p>
<p>=P{F(X′
iβ)y
</p>
<p>i
</p>
<p>[1−F(X′
iβ)]1−y
</p>
<p>i
</p>
<p>=F(X′
</p>
<p>iβ0)yi[1−F(X<sub>i</sub>′β0)]1−yi} (48)
</p>
<p>=P<sub>{</sub>F(X′
</p>
<p>iβ)yi[1−F(X
′
iβ)]
</p>
<p>1−yi <sub>=</sub><sub>F</sub><sub>(X</sub>′
</p>
<p>iβ0)yi[1−F(X<sub>i</sub>′β0)]1−yi|yi= 1}P(yi = 1) (49)
</p>
<p>+P<sub>{</sub>F(X′
iβ)y
</p>
<p>i
</p>
<p>[1<sub>−</sub>F(X′
iβ)]1−y
</p>
<p>i
</p>
<p>=F(X′
</p>
<p>iβ0)yi[1−F(X<sub>i</sub>′β0)]1−yi|yi= 0}P(yi = 0) (50)
</p>
<p>=P[F(X′
</p>
<p>iβ) =F(X
</p>
<p>′
</p>
<p>iβ0)|yi = 1]P(yi = 1) (51)
</p>
<p>+P[F(X′
</p>
<p>iβ) =F(X
</p>
<p>′
</p>
<p>iβ0)|yi = 0]P(yi = 0) (52)
</p>
<p>=P[F(X′
</p>
<p>iβ) =F(X
</p>
<p>′
</p>
<p>iβ0)] (53)
</p>
<p>となる。両辺をそれぞれ１から引くと
</p>
<p>P[f(yi|Xi;θ)≠ f(yi|Xi;θ0)] =P[F(X<sub>i</sub>′β)̸=F(X<sub>i</sub>′β0)]&gt;0 (54)
</p>
<p>を得る。なお、ここでf(yi|Xi;β)は密度ではなく確率である。
</p>
<p>(iv)’ logf(yi|Xi;β) = yilogF(Xi′β) + (1 −yi) log[1− F(Xi′β)]なので、yi = 0,1、
</p>
<p>F(<sub>−</sub>u) = 1<sub>−</sub>F(u)に注意して、
</p>
<p>E[|logf(yi|Xi;β)|]≤E[|logF(Xi′β)|] +E[|logF(−X
′
</p>
<p>iβ)|] (55)
</p>
<p>である。まず、プロビットモデル（F = Φ）のとき、<sub>|</sub>log Φ(u)<sub>| ≤ |</sub>log Φ(0)<sub>|</sub>+<sub>|</sub>u<sub>|</sub>+u2
</p>
<p>(Appendixを参照)であり、仮定からE(XiXi′)は有界なので、
</p>
<p>E[<sub>|</sub>log Φ(X′
</p>
<p>iβ)|] +E[|log Φ(−X
′
</p>
<p>iβ)|]≤2|log Φ(0)|+ 2E|X
′
</p>
<p>iβ|+ 2E(X
′
iβ)
</p>
<p>2
</p>
<p>&lt;<sub>∞</sub> (56)
となる。次にロジットモデル（F = Λ）の場合を考える。u<sub>≥</sub>0なら、Λ(0) <sub>≤</sub>Λ(u)&lt;1な
ので、
</p>
<p>|log Λ(u)<sub>| ≤ |</sub>log Λ(0)<sub>| ≤ |</sub>u<sub>|</sub>+<sub>|</sub>log Λ(0)<sub>|</sub> (57)
</p>
</div>
<div data-page='7' style='padding: 20px;margin: 10px auto;max-width: 800px;'><p>Page 7</p><p>である。exp(·)とlog(·)は単調増加関数なので、u &lt;0なら
</p>
<p>0&gt;log
[
</p>
<p>1
1 + exp(u)
</p>
<p>]
&gt;log
</p>
<p>[
1
1 + exp(0)
</p>
<p>]
</p>
<p>= log Λ(0) (58)
</p>
<p>である。よって
</p>
<p>|log Λ(u)<sub>|</sub>=



u+ log
</p>
<p>[
1
1 + exp(u)
</p>
<p>]<sub></sub>
</p>
<p>&lt;|u+ log Λ(0)|&lt;|u|+|log Λ(0)| (59)
なので、任意のuについて<sub>|</sub>log Λ(u)<sub>| ≤ |</sub>u<sub>|</sub>+<sub>|</sub>log Λ(0)<sub>|</sub>が成り立つ。よって、E<sub>|</sub>β′<sub>X</sub>
</p>
<p>i|&lt;∞
</p>
<p>なら押さえ込み条件(dominance condition)が成り立つが、それはE(XiXi′)の有界性から
</p>
<p>成立する。（証明終）
定理 2. 漸近正規性
</p>
<p>Θ =Rkで<sub>E(X</sub>
</p>
<p>iXi′)が非特異行列でE(∥XiXi′∥)&lt;∞ であるとき、
</p>
<p>√
</p>
<p>n( ˆβ<sub>−</sub>β0)
d
</p>
<p>→N(0, I(β0)
−1
</p>
<p>) (60)
</p>
<p>である。
</p>
<p>（証明） 命題3の(i)-(v)を示せばよい。(i)はΘ =Rkとして、成立する。(ii)は明らか
に成立する。
</p>
<p>(iii)スコアとへシアンはF = Λ,Φに対して
</p>
<p>s(yi, Xi;β0) =
</p>
<p>∂logf(yi|Xi;β0)
</p>
<p>∂β (61)
</p>
<p>= yi−F(X
</p>
<p>′
iβ0)
</p>
<p>F(X′
</p>
<p>iβ0)[1−F(X<sub>i</sub>′β0)]
</p>
<p>f(X′
</p>
<p>iβ0)Xi (62)
</p>
<p>H(yi, Xi;β0) =
</p>
<p>∂2
</p>
<p>logf(yi|Xi;β0)
</p>
<p>∂β∂β′ (63)
</p>
<p>= <sub>−</sub>
</p>
<p>{
</p>
<p>yi−F(X<sub>i</sub>′β0)
</p>
<p>F(X′
</p>
<p>iβ0)[1−F(X<sub>i</sub>′β0)]
</p>
<p>}2
</p>
<p>f(X′
iβ0)
</p>
<p>2
</p>
<p>XiXi′ (64)
</p>
<p>+ yi−F(X
</p>
<p>′
iβ0)
</p>
<p>F(X′
</p>
<p>iβ0)[1−F(X<sub>i</sub>′β0)]
</p>
<p>f′
</p>
<p>(X′
</p>
<p>iβ0)XiXi′ (65)
</p>
<p>である。E(yi|Xi) =E(y2i|Xi) =F(Xi′β0)なので、E[s(yi, Xi;β0)] = 0である。
</p>
<p>E[s(yi, Xi;β0)s(yi, Xi;β0)′|Xi] =
</p>
<p>E<sub>{</sub>[yi−F(Xi′β0)]2|Xi}
</p>
<p>F(X′
</p>
<p>iβ0)2[1−F(X<sub>i</sub>′β0)]2
</p>
<p>f(X′
</p>
<p>iβ0)2XiXi′ (66)
</p>
<p>= E(y
</p>
<p>2
</p>
<p>i|Xi)−F(Xi′β0)2
</p>
<p>F(X′
</p>
<p>iβ0)2[1−F(X<sub>i</sub>′β0)]2
</p>
<p>f(X′
iβ0)
</p>
<p>2
</p>
<p>XiXi′ (67)
</p>
<p>= 1
</p>
<p>F(X′
</p>
<p>iβ0)[1−F(X
′
iβ0)]
</p>
<p>f(X′
</p>
<p>iβ0)2XiXi′ (68)
</p>
<p>であり、E[yi−F(Xi′β0)|Xi] = 0なので
</p>
<p>E[H(yi, Xi;β0)|Xi] =−
</p>
<p>1
F(X′
</p>
<p>iβ0)[1−F(X<sub>i</sub>′β0)]
</p>
<p>f(X′
</p>
<p>iβ0)2XiXi′ (69)
</p>
<p>である。したがって、(iii)が成立する。
</p>
</div>
<div data-page='8' style='padding: 20px;margin: 10px auto;max-width: 800px;'><p>Page 8</p><p>(iv) プロビットモデルに関しては面倒である(Newey &amp; McFadden (1994, p.2147, Ex-
ample 1.2参照)が、ロジットモデルについては比較的簡単である。0<sub>≤</sub>Λ(X′
</p>
<p>iβ)≤1と(45)
</p>
<p>より、すべてのβにたいして 
</p>
<p>||H(yi, Xi;β)|| ≤ ||XiXi′|| (70)
</p>
<p>となるが、E<sub>||</sub>XiXi′||&lt;∞なので(iv)が成り立つ。
</p>
<p>(v) 1<sub>−</sub>Λ(X′
</p>
<p>iβ0) = Λ(−X<sub>i</sub>′β0)なので、任意のc &gt;0に対して、
</p>
<p>I(β0) = −E[H(yi, Xi;β0)] =E{Λ(X<sub>i</sub>′β0)[1−Λ(X<sub>i</sub>′β0)]XiXi′} (71)
</p>
<p>≥ E[I(<sub>|</sub>X′
</p>
<p>iβ0| ≤c)Λ(X<sub>i</sub>′β0)Λ(−X<sub>i</sub>′β0)XiXi′] (72)
</p>
<p>≥ Λ(<sub>−</sub>c)2E[I(<sub>|</sub>X′
</p>
<p>iβ0| ≤c)XiXi′] (73)
</p>
<p>最後の行列はcを十分大きくとれば非特異になる。したがって、I(β0)は非特異である。（証
</p>
<p>明終）
</p>
<p>6.5 切断回帰モデルと打ち切り回帰モデル（truncated regression, censored
regression model, Tobit model）
</p>
<p>もともとのモデルは線形回帰モデルであるが、被説明変数がある閾値以下の個体に関しては
観測値が得られない場合（truncated sample）や、ある閾値以下のときは被説明変数が（た
とえば非負制約によって）すべて0になってしまう場合を考える。例えば、労働供給時間、
購入する耐久消費財の価格、といったものが被説明変数である場合に生ずる。その場合、得
られたサンプルでOLS回帰を行うとバイアスが生ずる。なお、説明変数に閾値があって打
ち切られる場合はバイアスの問題は生じないため、問題なくOLS推定ができる。
</p>
<p>6.5.1 切断回帰モデル(Truncated regression model)
</p>
<p>(yi, Xi)は次の関係
</p>
<p>yi=Xi′β+ϵi (74)
</p>
<p>を満たすが、
</p>
<p>(yi, Xi) =
</p>
<p>{
</p>
<p>観測可能 (yi ≥0のとき)
</p>
<p>観測できない (yi &lt;0のとき)
</p>
<p>(75)
</p>
<p>という状況を考える。例えば、女性の労働力市場への参加・不参加の問題を考える際に、個
人iの労働時間をyi、属性をXiとすると、上のような構造を考えることができる。また、
</p>
<p>購入した耐久消費財の価格を説明するモデルにも上のような定式化が考えられる。yi &lt;0の
</p>
<p>個体については観測値がないとき、そのようなサンプルをtruncated sampleという。この
モデルも単純なOLS推定を行うことができない。ϵの密度関数、分布関数をf,Fとする。
</p>
<p>このようなモデルを分析するには、切断のある分布を考える必要がある。uの分布がc
より下で切断されているとき、切断された分布は
</p>
<p>f(u|u &gt; c) = f(u)
P(u &gt; c) =
</p>
<p>f(u)
</p>
<p>1−F(c) (76)
</p>
<p>である。u<sub>∼</sub>N(µ, σ2
</p>
<p>)とすると、切断された分布の期待値と分散は
</p>
<p>E(u<sub>|</sub>u &gt; c) = µ+σλ(v) (77)
</p>
<p>V ar(u<sub>|</sub>u &gt; c) = σ2<sub>{</sub>1<sub>−</sub>λ(v)[λ(v)<sub>−</sub>v]<sub>}</sub> (78)
</p>
</div>
<div data-page='9' style='padding: 20px;margin: 10px auto;max-width: 800px;'><p>Page 9</p><p>となる。ただし、v= (c−µ)/σ、λ(v) =ϕ(v)/[1−Φ(v)]で、ϕ,Φはそれぞれ標準正規分布の
密度関数と分布関数である。λ(v)は逆ミルズ比(inverse Mill’s ratio)、ハザード関数(hazard
function)と呼ばれる。以下、y∗
</p>
<p>|x<sub>∼</sub>N(x′<sub>β, σ</sub>2
</p>
<p>)を仮定してOLSとML推定法を紹介する。
(1)OLS推定
</p>
<p>u=y∗、<sub>c</sub><sub>= 0</sub>と考えて上の結果を用いると、切断回帰モデルについて
</p>
<p>E(yi|Xi) = Xi′β+σλ
</p>
<p>(
−X′
</p>
<p>iβ
</p>
<p>σ
)
</p>
<p>(79)
</p>
<p>V ar(yi|Xi) = σ2
</p>
<p>{
1<sub>−</sub>λ
</p>
<p>(
−X′
</p>
<p>iβ
</p>
<p>σ
) [
</p>
<p>λ
(
</p>
<p>−X′
iβ
</p>
<p>σ
)
</p>
<p>−−X
</p>
<p>′
iβ
</p>
<p>σ
]}
</p>
<p>を得る。従って、yiをXiに回帰するOLS推定ではβを推定できないことがわかる。なぜ
</p>
<p>なら、OLS推定を行うと、
</p>
<p>E( ˆβ|X) = (∑XiXi′
</p>
<p>)−1∑
</p>
<p>XiE(yi|Xi) (80)
</p>
<p>= (∑XiXi′
</p>
<p>)−1∑
</p>
<p>Xi
</p>
<p>[
X′
</p>
<p>iβ+σλ
</p>
<p>(
−X′
</p>
<p>iβ
</p>
<p>σ
)]
</p>
<p>(81)
</p>
<p>= β+σ(∑XiXi′
</p>
<p>)−1∑
</p>
<p>Xiλ
</p>
<p>(
−X′
</p>
<p>iβ
</p>
<p>σ
)
</p>
<p>(82)
</p>
<p>となり、バイアスを生ずる。
(2) ML推定
</p>
<p>個体iの切断前の条件付き密度関数は
</p>
<p>f(yi|Xi;β, σ2) =
</p>
<p>1
√
</p>
<p>2πσexp
[
</p>
<p>−(yi−X
</p>
<p>′
iβ)
</p>
<p>2
</p>
<p>2σ2
</p>
<p>]
= 1
</p>
<p>σϕ
(
</p>
<p>yi−Xi′β
</p>
<p>σ
)
</p>
<p>(83)
</p>
<p>であり、
</p>
<p>P(X′
</p>
<p>iβ+ϵi ≥0|Xi) = 1−P(Xi′β+ϵi&lt;0|Xi) (84)
</p>
<p>= 1−Φ
(
</p>
<p>−X′
iβ
</p>
<p>σ
)
</p>
<p>(85)
</p>
<p>= Φ
(
</p>
<p>X′
iβ
</p>
<p>σ
)
</p>
<p>(86)
</p>
<p>なので、(76)より切断条件付き密度関数は
</p>
<p>f(yi|Xi, Xi′β+ϵi ≥0;β, σ
2
</p>
<p>) =
</p>
<p>1
σϕ(
</p>
<p>yi−X′iβ
</p>
<p>σ )
</p>
<p>Φ(Xi′β
</p>
<p>σ )
</p>
<p>(87)
</p>
<p>である。従って、観測値(yi, Xi), i= 1,· · ·, nを得たときの対数尤度関数は
</p>
<p>logL(β, σ2) =<sub>−</sub>n
</p>
<p>2 log(2π)−
n
2 logσ
</p>
<p>2
</p>
<p>−1
2
</p>
<p>n
</p>
<p>∑
</p>
<p>i=1
</p>
<p>(
</p>
<p>yi−Xi′β
</p>
<p>σ
)2
</p>
<p>−
</p>
<p>n
</p>
<p>∑
</p>
<p>i=1
</p>
<p>log Φ
(
</p>
<p>X′
iβ
</p>
<p>σ
)
</p>
<p>(88)
</p>
<p>である。これを最大化することにより、MLEが得られる。一般には、パラメータを変換し
て推定し、また漸近的性質を求めるほうが、簡単である。推定量は一致性と漸近正規性をも
つが、その導出は、Hayashi (2000, p515-516)を参照。
</p>
</div>
<div data-page='10' style='padding: 20px;margin: 10px auto;max-width: 800px;'><p>Page 10</p><p>6.5.2 打ち切り回帰モデル
</p>
<p>yi&lt;0の時に、yiは観測できないが、Xiは観測でき、またyi &lt;0と分かっているデータが
</p>
<p>取得される場合もある。この場合には、打ち切り回帰モデル(censored regression modelあ
</p>
<p>るいは、Type 1 Tobit model) という。このモデルに対しても、OLS推定量はバイアスを生
</p>
<p>ずる。なお、切断回帰モデルでは、yi&lt;0の個体については、(yi, Xi)が観測されない状況
</p>
<p>を考えた。
</p>
<p>（１） Heckmanの2段階推定
</p>
<p>Heckman (1976)は、回帰に基づく２段階推定量を提案した。１段階目はy &gt; 0の観
</p>
<p>測値をy = 1で置き換えたデータを用意してプロビットMLでβ/σを推定する。それを
λ(<sub>−</sub>X′
</p>
<p>iβ/σ)に代入してλˆi=λ(−Xi′β/σ)d を作り、２段階目にyiが正の観測値のみを用いて
</p>
<p>(79)に基づいてyiをXi,ˆλiにOLS回帰することによってβの推定量を得る、という方法で
</p>
<p>ある。これはCAN推定量である。詳細はAmemiya (1985, Sec. 10.4.3, p.368-)を参照。
（２） MLE
</p>
<p>y∗
</p>
<p>i ≥0 の個体に対する対数尤度は
</p>
<p>−1
</p>
<p>2log(2π)−
1
2logσ
</p>
<p>2
</p>
<p>−1
2
</p>
<p>(
</p>
<p>yi−Xi′β
</p>
<p>σ
)2
</p>
<p>(89)
で、y∗
</p>
<p>i &lt;0の個体に対する対数尤度は
</p>
<p>log Φ
(
</p>
<p>−X
</p>
<p>′
iβ
</p>
<p>σ
)
</p>
<p>(90)
なので、サンプル全体に対する条件付き対数尤度関数はn1=∑n<sub>i</sub>=1I(yi&gt;0)として
</p>
<p>logL(β, σ2) = <sub>−</sub>n1
</p>
<p>2 log(2π)−
n1
</p>
<p>2 logσ
</p>
<p>2
</p>
<p>−1<sub>2</sub>
</p>
<p>n
</p>
<p>∑
</p>
<p>i=1
</p>
<p>1(yi&gt;0)
</p>
<p>(
</p>
<p>yi−X<sub>i</sub>′β
</p>
<p>σ
)2
</p>
<p>(91)
</p>
<p>+
</p>
<p>n
</p>
<p>∑
</p>
<p>i=1
</p>
<p>1(yi= 0) log Φ
</p>
<p>(
−X
</p>
<p>′
iβ
</p>
<p>σ
)
</p>
<p>(92)
</p>
<p>= −n1
</p>
<p>2 log(2π)−
n1
</p>
<p>2 logσ
</p>
<p>2
</p>
<p>−1
2
</p>
<p>∑
</p>
<p>i:yi&gt;0
</p>
<p>(
</p>
<p>yi−Xi′β
</p>
<p>σ
)2
</p>
<p>(93)
</p>
<p>+ ∑
</p>
<p>i:yi=0
</p>
<p>log Φ
(
</p>
<p>−X
</p>
<p>′
iβ
</p>
<p>σ
)
</p>
<p>(94)
</p>
<p>これを最大化することによってMLEを得ることができ、一致性をもち、漸近正規で漸近的
に有効である。
</p>
<p>6.5.3 その他のTobit model
</p>
<p>切断がどのような変数に対して生じるか、何が観測されるかによって色々なTobit modelを
考えることができる。
</p>
<p>y∗
</p>
<p>1i = X
′
</p>
<p>1iβ1+ϵ1i (95)
</p>
<p>y∗
</p>
<p>2i = X
′
</p>
<p>2iβ2+ϵ2i (96)
</p>
<p>で、∗のついた変数は観測されない変数とする。
(1) Type 2 Tobit model
</p>
<p>yi =
</p>
<p>{
y∗
</p>
<p>2i (y
∗
</p>
<p>1i≥0のとき)
</p>
<p>0 (y∗
</p>
<p>1i&lt;0のとき)
</p>
<p>(97)
</p>
</div>
<div data-page='11' style='padding: 20px;margin: 10px auto;max-width: 800px;'><p>Page 11</p><p>(2) Type 3 Tobit model
</p>
<p>y1i =
</p>
<p>{
y∗
</p>
<p>1i (y∗1i ≥0のとき)
</p>
<p>0 (y∗
</p>
<p>1i &lt;0のとき)
</p>
<p>(98)
</p>
<p>y2i =
</p>
<p>{
y∗
</p>
<p>2i (y∗1i ≥0のとき)
</p>
<p>0 (y∗
</p>
<p>1i &lt;0のとき)
</p>
<p>(99)
</p>
<p>これらのモデルは原則的にML法で推定されるが、他にも実際のデータに合わせて様々なモ
デル、推定法が提案されている。
</p>
<p>References
</p>
<p>[1] T. Amemiya. Advanced Econometrics. Harvard University Press, Cambridge, Massachusetts,
1985.
</p>
<p>[2] F. Hayashi. Econometrics. Princeton University Press, 2000.
</p>
<p>[3] J. J. Heckman. The common structure of statistical models of truncation, sample selection and
limited dependent variables and a simple estimator for such models. InAnnals of Economic
and Social Measurement, Volume 5, number 4, pages 475–492. NBER, 1976.
</p>
<p>[4] W. K. Newey and D. McFadden. Large sample estimation and hypothesis testing. In R. F.
Engle and D. L. McFadden, editors,Handbook of Econometrics, volume 4, chapter 36, pages
2111–2245. Elsevier, 1994.
</p>
</div>
<div data-page='12' style='padding: 20px;margin: 10px auto;max-width: 800px;'><p>Page 12</p><p>Appendix
</p>
<p>定理1の証明のための、命題2の条件(iv)’のプロビットの場合の証明
任意のuに対して
</p>
<p>|log Φ(u)| ≤ |log Φ(0)|+|u|+u2 <sub>(100)</sub>
</p>
<p>である。
（証明）
</p>
<p>i)u &gt;0のとき、
</p>
<p>1<sub>≥</sub>Φ(u)&gt;Φ(0) (101)
</p>
<p>なので、
</p>
<p>0<sub>≥</sub>log Φ(u)&gt;log Φ(0) (102)
</p>
<p>である。したがって、
</p>
<p>|log Φ(u)<sub>|</sub>&lt;<sub>|</sub>log Φ(0)<sub>| ≤ |</sub>log Φ(0)<sub>|</sub>+<sub>|</sub>u<sub>|</sub>+u2 <sub>(103)</sub>
</p>
<p>となる。
</p>
<p>ii)u<sub>≤</sub>0のとき
</p>
<p>g(u) = Φ(u)<sub>−</sub>Φ(0) exp(u<sub>−</sub>u2<sub>) = Φ(u)</sub><sub>−</sub>1
</p>
<p>2exp(u−u
</p>
<p>2<sub>)</sub> <sub>(104)</sub>
</p>
<p>とおくと
</p>
<p>g′
</p>
<p>(u) = ϕ(u)−1<sub>2</sub>(1−2u) exp(u−u2<sub>)</sub> <sub>(105)</sub>
</p>
<p>= √1
2πexp
</p>
<p>(
−u<sub>2</sub>2
</p>
<p>) [
1 +
</p>
<p>√
2π
</p>
<p>2 (2u−1) exp
(
</p>
<p>u<sub>−</sub>u2
2
</p>
<p>)]
</p>
<p>(106)
</p>
<p>である。あらためて、
</p>
<p>h(u) = 1 +
√
</p>
<p>2π
</p>
<p>2 (2u−1) exp
(
</p>
<p>u−u<sub>2</sub>2
)
</p>
<p>(107)
</p>
<p>とおくとh(0) = 1−√π/2&lt;0、limu→−∞h(u) = 1である。また、
</p>
<p>h′
</p>
<p>(u) =
√
</p>
<p>2π
</p>
<p>2 [2 + (2u−1)(1−u)] exp
(
</p>
<p>u−u<sub>2</sub>2
)
</p>
<p>(108)
</p>
<p>なので、u<sub>≤</sub>0の範囲ではh(u)はu= (3<sub>−</sub>√17)/4で（負の）最小値を取り、またu &lt;(3<sub>−</sub>√17)/4
では単調減少、u &gt;(3<sub>−</sub>√17)/4では単調増加関数である。以上から、あるu∗が存在して、
</p>
<p>h(u)
{
</p>
<p>&lt;0 (u≥u∗のとき)
</p>
<p>≥0 (u &lt; u∗のとき) (109)
</p>
<p>が成り立つ。したがって、
</p>
<p>g′
</p>
<p>(u)
{
</p>
<p>&lt;0 (u≥u∗のとき)
</p>
<p>≥0 (u &lt; u∗のとき) (110)
</p>
<p>となる。ここで、g(0) = 0である。
</p>
<p>lim
</p>
<p>u→−∞g(u) = u→−∞lim
</p>
<p>[
</p>
<p>Φ(u)<sub>−</sub>1
</p>
<p>2exp(u−u
</p>
<p>2<sub>)</sub>
</p>
<p>]
</p>
<p>(111)
</p>
<p>= lim
</p>
<p>u→−∞
</p>
<p>[
Φ(u)
exp(−u2
</p>
<p>2)
</p>
<p>−1<sub>2</sub>exp
(
</p>
<p>u−u<sub>2</sub>2
)]
</p>
<p>exp
(
</p>
<p>−u<sub>2</sub>2
)
</p>
<p>(112)
</p>
</div>
<div data-page='13' style='padding: 20px;margin: 10px auto;max-width: 800px;'><p>Page 13</p><p>で、
</p>
<p>lim
</p>
<p>u→−∞exp
</p>
<p>(
−u<sub>2</sub>2
</p>
<p>)
</p>
<p>= 0, lim
</p>
<p>u→−∞exp
</p>
<p>(
u−u<sub>2</sub>2
</p>
<p>)
</p>
<p>= 0 (113)
</p>
<p>lim
</p>
<p>u→−∞
</p>
<p>Φ(u)
exp(−u2
</p>
<p>2)
</p>
<p>= lim
</p>
<p>u→−∞
</p>
<p>ϕ(u)
−uexp(−u2
</p>
<p>2)
</p>
<p>= 0 (114)
</p>
<p>なので、limu→−∞g(u) = 0である。したがって、u≤0のときg(u)≥0である。
</p>
<p>したがって、対数関数の単調性より
</p>
<p>log Φ(u)≥log Φ(0) +u−u2 <sub>(115)</sub>
</p>
<p>−log Φ(u)<sub>≤ −</sub>log Φ(0)<sub>−</sub>u+u2 <sub>(116)</sub>
</p>
<p>またlog Φ(u)<sub>≤</sub>0, log Φ(0)<sub>≤</sub>0, u<sub>≤</sub>0なので
</p>
<p>|log Φ(u)<sub>| ≤ |</sub>log Φ(0)<sub>|</sub>+<sub>|</sub>u<sub>|</sub>+u2 <sub>(117)</sub>
</p>
<p>となる。（証明終）
</p>
</div></body>